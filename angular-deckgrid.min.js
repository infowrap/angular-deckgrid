/*! angular-deckgrid (v0.3.9) - Copyright: 2013, André König (andre.koenig@posteo.de) - MIT */
angular.module("akoenig.deckgrid",[]),angular.module("akoenig.deckgrid").directive("deckgridCard",["DeckgridDescriptor",function(a){"use strict";return a.create("card")}]).directive("deckgridAsset",["DeckgridDescriptor",function(a){"use strict";return a.create("asset")}]).directive("deckgridGallery",["DeckgridDescriptor",function(a){"use strict";return a.create("gallery")}]),angular.module("akoenig.deckgrid").factory("DeckgridDescriptor",["Deckgrid",function(a){"use strict";function b(a){this.restrict="AE";var b='data-bb-wrap-card="item"',c="",d="",e="";"asset"===a?(b='data-bb-wrap-asset="item"',d='<div data-ng-if="mother.section.assets.length == 0" class="{{layout.classList}}" ><div class="component learn" data-type="{{mother.section.type}}" data-icon="{{mother.section.type}}" ></div></div>',e='<div class="{{layout.classList}}" data-ng-if="mother.section.type!=\'file\' && $root.activeWrap.editable" ><div data-resource-edit class="component new" data-ng-class="$root.classForSectionType(mother.section)" data-allow-new="true" data-id="$root.activeWrap.id" data-title="{{$root.addComponentTitleForSection(mother.section)}}" data-type="{{mother.section.type}}" data-layout="{{mother.section.type}}" data-modal-class-name="{{$root.classForSectionType(mother.section)}}" ></div></div><div class="{{layout.classList}}" data-ng-if="mother.section.type==\'file\' && $root.isDetailPage && $root.activeWrap.editable" ><div class="component new" data-ng-class="$root.classForSectionType(mother.section)" data-filepicker-btn data-store-location="S3" data-target-id="$root.activeWrap.id" data-target-type="wrap" ></div></div>'):"gallery"===a&&(b='data-ng-click="$event.stopPropagation(); mother.showSlide(item.id);" class="image" data-has-image="true"',c='<div class="spinner" data-icon="spinner"></div> <img data-unveil-item="item.asset" class="contents unveil-item" data-target-load=".image" data-force="true" data-constrain-width="270" data-fit="clip" src="data:image/gif;base64,R0lGODlhdQLcAIAAAP///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4zLWMwMTEgNjYuMTQ1NjYxLCAyMDEyLzAyLzA2LTE0OjU2OjI3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkQzNjU5OTdEN0M5MTExRTNBNjc3QjZDQzk1RTc0MDQzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkQzNjU5OTdFN0M5MTExRTNBNjc3QjZDQzk1RTc0MDQzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDM2NTk5N0I3QzkxMTFFM0E2NzdCNkNDOTVFNzQwNDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDM2NTk5N0M3QzkxMTFFM0E2NzdCNkNDOTVFNzQwNDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQBAAAAACwAAAAAdQLcAAAC/4SPqcvtD6OctNqLs968+w+G4kiW5omm6sq27gvH8kzX9o3n+s73/g8MCofEovGITCqXzKbzCY1Kp9Sq9YrNarfcrvcLDovH5LL5jE6r1+y2+w2Py+f0uv2Oz+v3/L7/DxgoOEhYaHiImKi4yNjo+AgZKTlJWWl5iZmpucnZ6fkJGio6SlpqeoqaqrrK2ur6ChsrO0tba3uLm6u7y9vr+wscLDxMXGx8jJysvMzc7PwMHS09TV1tfY2drb3N3e39DR4uPk5ebn6Onq6+zt7u/g4fLz9PX29/j5+vv8/f7/8PMKDAgQQLGjyIMKHChQwbOnwIMaLEiRQrWryIMaPGjf8cO3r8CDKkyJEkS5o8iTKlypUsW7p8CTOmzJk0a9q8iTOnzp08e/r8CTSo0KFEixo9ijSp0qVMmzp9CjWq1KlUq1q9ijWr1q1cu3r9Cjas2LFky5o9izat2rVs27p9Czeu3Ll069q9izev3r18+/r9Cziw4MGECxs+jDix4sWMGzt+DDmy5MmUK1u+jDmz5s2cO3v+DDq06NGkS5s+jTq16tWsW7t+DTu27Nm0a9u+jTu37t28e/v+DTy48OHEixs/jjy58uXMmzt/Dj269OnUq1u/jj279u3cu3v/Dj68+PHky5s/jz69+vXs27t/Dz++/Pn069u/jz+//v38+/sb/w9ggAIOSGCBBh6IYIIKLshggw4+CGGENRUAADs="/><div data-ng-show="mother.editing" data-icon="delete" data-ng-click="$event.stopPropagation(); mother.removeImage(item.id);" ></div> </div>',e='<div class="image new" data-has-image="false" data-editor="true" data-filepicker-btn data-ng-show="mother.editing" data-process-when="$root.activeWrap.editable" data-store-location="S3" data-mime-types="image/*" data-target-id="mother.asset.id" data-target-parent-id="$root.activeWrap.id" data-target-type="gallery" data-title="Add Images" ></div>'),this.template=d+'<div data-ng-repeat="column in columns" class="{{layout.classList}}"><div data-ng-repeat="item in column" '+b+">"+c+"</div></div>"+e,this.scope={model:"=source"},this.$$deckgrid=null,this.link=this.$$link.bind(this)}return b.prototype.$$destroy=function(){this.$$deckgrid.destroy()},b.prototype.$$link=function(b,c){b.$on("$destroy",this.$$destroy.bind(this)),b.mother=b.$parent,this.$$deckgrid=a.create(b,c[0])},{create:function(a){return new b(a)}}}]),angular.module("akoenig.deckgrid").factory("Deckgrid",["$window","$log","$rootScope",function(a,b,c){"use strict";function d(a,b){var c,d=this;this.$$elem=b,this.$$watchers=[],this.$$scope=a,this.$$scope.columns=[],this.$$scope.layout=this.$$getLayout(),this.$$createColumns(),c=this.$$scope.$watch("model",this.$$onModelChange.bind(this),!0),this.$$watchers.push(c),angular.forEach(d.$$getMediaQueries(),function(a){function b(){a.removeListener(d.$$onMediaQueryChange.bind(d))}a.addListener(d.$$onMediaQueryChange.bind(d)),d.$$watchers.push(b)})}return d.prototype.$$getMediaQueries=function(){function b(a){for(var b=0;b<a.cssRules.length;b++){var c=a.cssRules[b];if(c.selectorText&&c.selectorText.indexOf("deckgrid[data-deckgrid-card]::before")>-1)return!0}return!1}var c=[],d=document.styleSheets;return angular.forEach(d,function(d){var e=d.cssRules;angular.forEach(e,function(d){d.constructor===CSSMediaRule&&b(d)&&c.push(a.matchMedia(d.media.mediaText))})}),c},d.prototype.$$createColumns=function(){var a=this;return this.$$scope.layout?(this.$$scope.columns=[],void angular.forEach(this.$$scope.model,function(b,c){var d=c%a.$$scope.layout.columns|0;a.$$scope.columns[d]||(a.$$scope.columns[d]=[]),a.$$scope.columns[d].push(b)})):b.error("angular-deckgrid: No CSS configuration found (see https://github.com/akoenig/angular-deckgrid#the-grid-configuration)")},d.prototype.$$getLayout=function(){var b,c=a.getComputedStyle(this.$$elem,":before").content;return c&&(c=c.replace(/'/g,""),c=c.replace(/"/g,""),c=c.split(" "),2===c.length&&(b={},b.columns=0|c[0],b.classList=c[1].replace(/\./g," ").trim())),b},d.prototype.$$onMediaQueryChange=function(){var a=this,b=this.$$getLayout();if(b&&b.columns!==this.$$scope.layout.columns){a.$$scope.layout=b;var d=function(){a.$$createColumns()},e=c.$$phase;"$apply"===e||"$digest"===e?d():a.$$scope.$apply(d)}},d.prototype.$$onModelChange=function(a,b){var c=this;a&&(angular.isUndefined(b)?c.$$createColumns():a.length!==b.length?c.$$createColumns():a.length>0&&(angular.isUndefined(c.$$scope.columns)||0===c.$$scope.columns.length)&&c.$$createColumns())},d.prototype.destroy=function(){var a=this.$$watchers.length-1;for(a;a>=0;a-=1)this.$$watchers[a]()},{create:function(a,b){return new d(a,b)}}}]);